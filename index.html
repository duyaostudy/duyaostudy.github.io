<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>冰海</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="冰海"><meta name="msapplication-TileImage" content="/img/ice-favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="冰海"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="个人博客，记录每一次成长"><meta property="og:type" content="blog"><meta property="og:title" content="冰海"><meta property="og:url" content="http://duyaostudy.github.io/"><meta property="og:site_name" content="冰海"><meta property="og:description" content="个人博客，记录每一次成长"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://duyaostudy.github.io/img/og_image.png"><meta property="article:author" content="duyao"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://duyaostudy.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://duyaostudy.github.io"},"headline":"冰海","image":["http://duyaostudy.github.io/img/og_image.png"],"author":{"@type":"Person","name":"duyao"},"publisher":{"@type":"Organization","name":"冰海","logo":{"@type":"ImageObject","url":"http://duyaostudy.github.io/img/ice-logo.svg"}},"description":"个人博客，记录每一次成长"}</script><link rel="icon" href="/img/ice-favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/ice-logo.svg" alt="冰海" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">主页</a><a class="navbar-item" href="/archives">文章</a><a class="navbar-item" href="/categories">类别</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/duyaostudy/hexo-theme-icarus-duyao-duyao"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-12-16T04:53:30.127Z" title="2022/12/16 12:53:30">2022-12-16</time>发表</span><span class="level-item"><time dateTime="2022-12-16T04:54:19.399Z" title="2022/12/16 12:54:19">2022-12-16</time>更新</span><span class="level-item">38 分钟读完 (大约5659个字)</span></div></div><div class="content"><h1 id="Spring5"><a href="#Spring5" class="headerlink" title="Spring5"></a>Spring5</h1><h2 id="1-1-概念概述"><a href="#1-1-概念概述" class="headerlink" title="1.1 概念概述"></a>1.1 概念概述</h2><blockquote>
<ol>
<li>是一个轻量级开源JavaEE框架</li>
<li>Spring可以解决企业应用开发的复杂性</li>
<li>Spring两核心： IOC和Aop<ol>
<li>IOC：控制反转，把创建对象的过程交给Spring管理</li>
<li>Aop：面向切面，不修改源代码的情况下对功能进行增强</li>
</ol>
</li>
<li>Spring特点<ol>
<li>方便解耦，简化开发</li>
<li>Aop编程支持</li>
<li>方便程序测试</li>
<li>方便集成各种优秀框架</li>
<li>降低JavaEE的使用难度</li>
<li>方便进行事务的操作</li>
<li>降低API开发难度</li>
<li>Java源码的经典示范</li>
</ol>
</li>
</ol>
</blockquote>
<h2 id="IOC容器"><a href="#IOC容器" class="headerlink" title="IOC容器"></a>IOC容器</h2><h3 id="1-IOC"><a href="#1-IOC" class="headerlink" title="1 IOC"></a>1 IOC</h3><h4 id="1-什么是IOC："><a href="#1-什么是IOC：" class="headerlink" title="1. 什么是IOC："></a>1. 什么是IOC：</h4><blockquote>
<ol>
<li>容器</li>
<li>控制反转：将对象创建和调用都交给spring进行管理</li>
<li>目的：降低耦合度</li>
</ol>
</blockquote>
<h4 id="2-底层原理"><a href="#2-底层原理" class="headerlink" title="2. 底层原理"></a>2. 底层原理</h4><blockquote>
<ol>
<li><p>xml解析、工厂模式、反射</p>
<ol>
<li><p>工厂模式：</p>
<ol>
<li><p>&#96;&#96;&#96;java<br>class Userservice{<br>execute(){<br>    UserDao dao &#x3D; UserFactory.getDao();<br>    dao.add();<br>}<br>}</p>
<p>class UserDao{<br>add(){<br>    ….<br>}<br>}</p>
<p>class UserFactory{<br>public static UserDao getDao(){<br>    return new UserDao();<br>}<br>}</p>
<pre class="line-numbers language-none"><code class="language-none">
         2. 目的：让耦合度降低到最低限度

#### 3. IOC过程：

   1. xml配置文件，配置创建的对象

      1. &#96;&#96;&#96;xml
         &lt;bean id&#x3D;&quot;dao&quot; class&#x3D;&quot;com.dy.UserDao&quot;&gt;&lt;&#x2F;bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
</ol>
</li>
<li><p>有service类和dao类，创建工厂类</p>
<ol>
<li>&#96;&#96;&#96;java<br>class UserFactory{<br>public static UserDao getDao(){<br>    String classValue &#x3D; class属性值;&#x2F;&#x2F;1. xml解析<br>    Class clazz &#x3D; Class.forName(classValue);&#x2F;&#x2F; 2. 通过反射创建对象<br>    return clazz.newInstance();<br><br>}<pre class="line-numbers language-none"><code class="language-none">
#### 4. IOC接口

   1. IOC思想基于IOC容器完成，IOC容器底层就是对象工厂
   2. Spring提高IOC容器实现的两种方式（两种接口）：
      1. BeanFactory：IOC容器基本实现，spring内部使用接口，一般不提供给开发人员
         1. 加载配置文件时不会创建对象，获取对象时才去创建对象
      2. ApplicationContext：BeanFactory接口的子接口，提高更多更强大的功能，一般使用与开发人员
         1. 加载配置文件时就会把配置文件创建了
      3. ApplicationContext实现类：
         1. ![image-20220326112518394](C:\Users\86152\AppData\Roaming\Typora\typora-user-images\image-20220326112518394.png)
            1. Class类是相当于xml读取相对路径
            2. File类相当于xml读取绝对路径

### 2 IOC操作Bean管理

#### Bean管理
1. Spring创建对象
2. Spring注入属性
3. Bean管理操作有两种方式
   1. 基于xml配置文件方式实现
   2. 基于注解方式实现


#### IOC管理方式实现

#####  1. 基于xml方式实现

&gt;1. id属性：唯一标识，
&gt;1. class属性：类全路径（包类路径）
&gt;1. name属性：和id属性类似，但不能使用特殊字符（现不常用）
&gt;1. 创建对象时默认执行的无参数构造方法完成创建**


&#96;&#96;&#96;java
&lt;bean id&#x3D;&quot;user&quot; class&#x3D;&quot;com.dy.spring.study.User&quot;&gt;&lt;&#x2F;bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
</ol>
</blockquote>
<h5 id="2-基于xml方式注入属性"><a href="#2-基于xml方式注入属性" class="headerlink" title="2. 基于xml方式注入属性"></a>2. 基于xml方式注入属性</h5><blockquote>
<ol>
<li><p>DI：依赖注入，注入属性</p>
</li>
<li><p>先创建对象，再注入属性</p>
</li>
</ol>
</blockquote>
<h5 id="3-set方法注入"><a href="#3-set方法注入" class="headerlink" title="3.set方法注入"></a>3.set方法注入</h5><blockquote>
<ol>
<li><p>创建Book对象，用set方法进行属性注入</p>
</li>
<li><p>name属性名称 value属性值</p>
</li>
<li><pre><code class="Java">   &lt;bean id=&quot;book&quot; class=&quot;com.dy.spring.study.Book&quot;&gt;
   //使用property完成属性注入    
   &lt;property name=&quot;bname&quot; value=&quot;hello world&quot;&gt;&lt;/property&gt;
   &lt;property name=&quot;bauthor&quot; value=&quot;dy&quot;&gt;&lt;/property&gt;
   &lt;/bean&gt;
   <pre class="line-numbers language-none"><code class="language-none">
&gt;6. 默认找Book方法里面的set方法，set方法不一致就会报错


##### 4. 有参构造注入

&gt;1. 创建类、定义属性、定义属性的构造方法
&gt;2. 配置spring文件

&gt;1. &#96;&#96;&#96;java
   &lt;!--有参数构造注入属性--&gt;
    &lt;!--constructor_org进行参数注入--&gt;
          &lt;bean id&#x3D;&quot;orders&quot; class&#x3D;&quot;com.dy.spring.study.Orders&quot;&gt;
              &#x2F;&#x2F;属性名称注入属性
                  &lt;constructor-arg name&#x3D;&quot;address&quot; value&#x3D;&quot;中国&quot;&gt;&lt;&#x2F;constructor-arg&gt;
              &#x2F;&#x2F;数组下标位置注入属性
                  &lt;constructor-arg index&#x3D;&quot;0&quot; value&#x3D;&quot;1002&quot;&gt;&lt;&#x2F;constructor-arg&gt;
          &lt;&#x2F;bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
<li><p>p名称空间注入（了解）</p>
</li>
</ol>
</blockquote>
<h5 id="5-简化基于xml配置的方式"><a href="#5-简化基于xml配置的方式" class="headerlink" title="5. 简化基于xml配置的方式"></a>5. 简化基于xml配置的方式</h5><blockquote>
<ol>
<li><p>添加p名称空间再xml文件当中</p>
</li>
<li><pre><code class="java">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
       xmlns:p=&quot;http://www.springframework.org/schema/p&quot;
       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;&gt;
<pre class="line-numbers language-none"><code class="language-none">
&gt;2. 进行属性注入

  1. &#96;&#96;&#96;java
      &lt;bean id&#x3D;&quot;book&quot; class&#x3D;&quot;com.dy.spring.study.Book&quot; p:bname&#x3D;&quot;阿三&quot; p:bauthor&#x3D;&quot;无名狮子&quot;&lt;&#x2F;bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
<li><p>底层基于set方法注入属性</p>
</li>
<li><p>DI是IOC的一种具体实现</p>
</li>
</ol>
</blockquote>
<h4 id="xml注入其他类型属性："><a href="#xml注入其他类型属性：" class="headerlink" title="xml注入其他类型属性："></a>xml注入其他类型属性：</h4><blockquote>
<ol>
<li><p>字面量</p>
</li>
<li><p>空值</p>
</li>
</ol>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">  <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"bname"</span><span class="token operator">></span>
     <span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">null</span><span class="token punctuation">></span></span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">null</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
<span class="token comment">//属性值赋值为空值    </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li><p>属性值包含特殊值</p>
</li>
<li><p>把特殊符合进行转义</p>
</li>
<li><p>&lt;&gt; 特殊字符</p>
</li>
</ol>
  <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token operator">&amp;</span>lt<span class="token punctuation">;</span> <span class="token operator">&amp;</span>gt<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ol start="3">
<li><p>把特殊符号内容写道CDATA</p>
</li>
<li><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bauthor<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span><span class="token cdata">&lt;![CDATA[&lt;&lt;南京>>]]></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><![CDATA[<<南京>>]]></li>
</ol>
</blockquote>
<h5 id="注入属性-外部bean"><a href="#注入属性-外部bean" class="headerlink" title="注入属性-外部bean"></a>注入属性-外部bean</h5><blockquote>
<ol>
<li><p>先创建dao,service类里导入dao类，在bean里注入外部类</p>
</li>
<li><pre><code class="xml">&lt;bean id=&quot;userService&quot; class=&quot;com.dy.spring.service.UserService&quot;&gt;
     &lt;!-- 
         name中添加的是属性名称
         ref:创建userDao对象bean标签的id值
     --&gt;
     //接口类
    &lt;property name=&quot;userdao&quot; ref=&quot;userDaoImp&quot;&gt;&lt;/property&gt;
&lt;/bean&gt;
                                                                                                                                       
                                                //实现类
 &lt;bean id=&quot;userDaoImp&quot; class=&quot;com.dy.spring.dao.UserDaoImp&quot;&gt;&lt;/bean&gt;
<pre class="line-numbers language-none"><code class="language-none">

##### 注入属性-内部bean和级联赋值


1. 一对多关系

2. 内部bean

1. bean文件配置

2. &#96;&#96;&#96;xml
   &lt;!--    内部bean--&gt;
   &lt;bean id&#x3D;&quot;emp&quot; class&#x3D;&quot;com.dy.spring.bean.Emp&quot;&gt;
                                                                                                                                         
		&lt;!--    设置两个普通属性--&gt;
	    &lt;property name&#x3D;&quot;ename&quot; value&#x3D;&quot;张三&quot;&gt;&lt;&#x2F;property&gt;
	    &lt;property name&#x3D;&quot;genderl&quot; value&#x3D;&quot;男&quot;&gt;&lt;&#x2F;property&gt;
	    &lt;property name&#x3D;&quot;dep&quot;&gt;
	        &lt;!--    在属性中引入需要的bean--&gt;
	        &lt;bean id&#x3D;&quot;dep&quot; class&#x3D;&quot;com.dy.spring.bean.Dept&quot;&gt;
	        	&lt;property name&#x3D;&quot;dname&quot; value&#x3D;&quot;财务&quot;&gt;&lt;&#x2F;property&gt;
           &lt;&#x2F;bean&gt;
      &lt;&#x2F;property&gt;
   &lt;&#x2F;bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
<li><p>emp类属性</p>
</li>
<li><p>&#96;&#96;&#96;<br>private String ename;<br>private String genderl;<br>&#x2F;&#x2F;  员工属于某一个部门<br>private Dept dep;</p>
<pre class="line-numbers language-none"><code class="language-none">
3. 级联赋值

   1. &#96;&#96;&#96;xml
      &lt;bean id&#x3D;&quot;emp&quot; class&#x3D;&quot;com.dy.spring.service.Emp&quot;&gt;
      	&lt;property name&#x3D;&quot;dep&quot; ref&#x3D;&quot;dep&quot;&gt;&lt;&#x2F;property&gt;
      &lt;&#x2F;bean&gt;
      &lt;bean id&#x3D;&quot;dep&quot; class&#x3D;&quot;com.dy.spring.dao.Dept&quot;&gt;
      	&lt;property name&#x3D;&quot;dname&quot; value&#x3D;&quot;财务&quot;&gt;&lt;&#x2F;property&gt;
      &lt;&#x2F;bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</blockquote>
<h5 id="注入集合属性"><a href="#注入集合属性" class="headerlink" title="注入集合属性"></a>注入集合属性</h5><blockquote>
<ol>
<li><p>注入数组</p>
</li>
<li><p>注入List集合类型属性</p>
</li>
<li><p>注入Map集合类型属性</p>
</li>
<li><pre><code class="xml">&lt;!--    集合注入--&gt;
        &lt;bean name=&quot;stu&quot; class=&quot;com.dy.spring.collectiontype.Student&quot;&gt;
&lt;!--    数组属性注入--&gt;
            &lt;property name=&quot;course&quot;&gt;
                &lt;array&gt;
                    &lt;value&gt;java课程&lt;/value&gt;
                    &lt;value&gt;数据库课程&lt;/value&gt;
                &lt;/array&gt;
            &lt;/property&gt;
&lt;!--    list属性注入--&gt;
            &lt;property name=&quot;name&quot;&gt;
                &lt;list&gt;
                    &lt;value&gt;张三&lt;/value&gt;
                    &lt;value&gt;王二&lt;/value&gt;
                &lt;/list&gt;
            &lt;/property&gt;
&lt;!--    Map属性注入--&gt;
            &lt;property name=&quot;maps&quot;&gt;
                &lt;map&gt;
                    &lt;entry key=&quot;JAVA&quot; value=&quot;java&quot;&gt;&lt;/entry&gt;
                    &lt;entry key=&quot;PHP&quot; value=&quot;php&quot;&gt;&lt;/entry&gt;
                &lt;/map&gt;
            &lt;/property&gt;
&lt;!--    set属性注入--&gt;
            &lt;property name=&quot;sets&quot;&gt;
                &lt;set&gt;
                    &lt;value&gt;1&lt;/value&gt;
                    &lt;value&gt;2&lt;/value&gt;
                &lt;/set&gt;
            &lt;/property&gt;
        &lt;/bean&gt;
<pre class="line-numbers language-none"><code class="language-none">
&gt;4. 在集合里面设置对象类型值


1. 与级联赋值同理

&gt;&#96;&#96;&#96;xml
 &lt;property name&#x3D;&quot;list&quot;&gt;
 	&lt;list&gt;
      	&lt;ref bean&#x3D;&quot;course1&quot;&gt;&lt;&#x2F;ref&gt;
       &lt;ref bean&#x3D;&quot;course2&quot;&gt;&lt;&#x2F;ref&gt;
      &lt;&#x2F;list&gt;
  &lt;&#x2F;property&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
<li></li>
<li><p>把集合中属性提取出来作为公共部分</p>
</li>
<li><p>在spring配置空间引入util</p>
</li>
</ol>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">>xsi:schemaLocation="http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
>http://www.springframework.org/schema/util 
>https://www.springframework.org/schema/util/spring-beans.xsd"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li><p>地址配置</p>
</li>
<li><p>提取list集合类型属性注入</p>
</li>
</ol>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup">  <span class="token comment">&lt;!--    提取list集合类型属性注入--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">util:</span>list</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bookList<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>java基础<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>javaspring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">></span></span>springboot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">util:</span>list</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>book<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.dy.spring.study.Book<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bname<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bookList<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>bauthor<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>中国<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

</blockquote>
<h4 id="FactoryBean"><a href="#FactoryBean" class="headerlink" title="FactoryBean"></a>FactoryBean</h4><blockquote>
<ol>
<li><p>普通beans:定义类型就是返回类型</p>
</li>
<li><p>工厂beans:在配置文件定义benas类型可以和返回类型不一样</p>
<ol>
<li><p>方法接口为 FactoryBean，修改getObject方法作为返回值类型</p>
</li>
<li><pre><code class="Java">public class MyBean implements FactoryBean&lt;Course&gt; &#123;
    @Override
    public Course getObject() throws Exception &#123;
        Course course = new Course();
        course.setName(&quot;javaee基础&quot;);
        return course;
    &#125;
<pre class="line-numbers language-none"><code class="language-none">
3. xml文件引用

4. &#96;&#96;&#96;xml
   &lt;bean id&#x3D;&quot;mybean&quot; class&#x3D;&quot;com.dy.spring.bean.MyBean&quot;&gt;&lt;&#x2F;bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
<li><p>方法实现</p>
</li>
<li><pre><code class="java">public void MyBean()&#123;
                                                                                                                                                                                                                                                                              
    ApplicationContext context = new ClassPathXmlApplicationContext(&quot;beans.xml&quot;);
    Course course = context.getBean(&quot;mybean&quot;, Course.class);
    System.out.println(course);
&#125;
<pre class="line-numbers language-none"><code class="language-none">
#### bean作用域

1. spring默认单实例对象，每次加载后只创建一个对象

2. 多实例对象：

   &#96;&#96;&#96;xml
   &lt;bean id&#x3D;&quot;book&quot; class&#x3D;&quot;com.dy.spring.study.Book&quot; scope&#x3D;&quot;singleton&quot;&gt;&lt;&#x2F;bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
<li><p>bean里的scope属性里的值</p>
<ol>
<li>singleton(默认)：单实例<ol>
<li>创建spring配置文件时候就会创建一个单实例对象</li>
</ol>
</li>
<li>protorype：创建多实例<ol>
<li>在调用getBean方法后创建实例对象</li>
</ol>
</li>
<li>request：创建对象时，将对象放入到request中</li>
<li>session：创建对象时，将对象放入到session中</li>
</ol>
</li>
</ol>
</li>
</ol>
</blockquote>
<h4 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h4><blockquote>
<p>对象创建到销毁的过程</p>
<ol>
<li><p>bean的生命周期：</p>
<ol>
<li>通过构造器创建bean实例（通过无参数构创建）</li>
<li>对bean属性设置和对其他bean应用（调用set方法）<ol>
<li>把bean实例传递给后置处理器的方法（后置处理器）</li>
</ol>
</li>
<li>调用bean初始化方法        （需要配置）init-method方法<ol>
<li>把bean实例传递给后置处理器的方法（后置处理器）</li>
</ol>
</li>
<li>bean可以使用（对象已获取）</li>
<li>容器关闭的时候，调用bean的销毁方法（需要进行配置销毁方法）</li>
</ol>
</li>
<li><p>创建——注入——初始化——关闭——销毁</p>
</li>
<li><p>例子</p>
<ol>
<li><p>init-method:初始化方法	destroy-method&#x3D;销毁方法</p>
</li>
<li><p>&#96;&#96;&#96;xml</p>
<bean id="book" class="com.dy.spring.study.Book" init-method="show" destroy-method="destroyMethod">
    <property name="bname" ref="bookList"></property>
    <property name="bauthor" value="中国"></property>
</bean>
<pre class="line-numbers language-none"><code class="language-none">
4. bean后置处理器，bean生命周期七步：

#### xml自动装配

根据指定装配规则（属性名称或者属性类型），spring自动将匹配的属性进行注入

1. 根据属性类型自动注入：autowire
   1. byName：根据属性名称注入，注入值bean和id值和类属性名称的一样
   2. btType：根据属性类型注入

#### 外部属性文件

1. 直接配置数据信息

   1. 配置德鲁伊连接池

   2. 引入德鲁伊jar包

      1. 配置数据库连接：

      2. &#96;&#96;&#96;xml
         &lt;bean id&#x3D;&quot;durid&quot; class&#x3D;&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt;
             &lt;property name&#x3D;&quot;driverClassName&quot; value&#x3D;&quot;com.mysql.jdbc.Driver&quot;&gt;&lt;&#x2F;property&gt;
             &lt;property name&#x3D;&quot;url&quot; value&#x3D;&quot;jdbc:mysql&#x2F;&#x2F;localhost:3306&#x2F;userdb&quot;&gt;&lt;&#x2F;property&gt;
             &lt;property name&#x3D;&quot;username&quot; value&#x3D;&quot;root&quot;&gt;&lt;&#x2F;property&gt;
             &lt;property name&#x3D;&quot;password&quot; value&#x3D;&quot;root&quot;&gt;&lt;&#x2F;property&gt;
         &lt;&#x2F;bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="3">
<li><p>加载配置文件的方式</p>
<ol>
<li><p>添加jdbc.properties文件</p>
<ol>
<li>&#96;&#96;&#96;properties<br>prpo.driverClass&#x3D;com.mysql.jdbc.Driver<br>prpo.url&#x3D;jdbc:mysql&#x2F;&#x2F;localhost:3306&#x2F;userdb<br>prpo.userName&#x3D;root<br>prpo.password&#x3D;root<pre class="line-numbers language-none"><code class="language-none">
2. bean导入属性文件，配置数据库连接

   1. &#96;&#96;&#96;xml
      &lt;!--在spring引入外部属性文件--&gt;
          &lt;context:property-placeholder location&#x3D;&quot;classpath:jdbc.properties&quot;&#x2F;&gt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
          &lt;!--连接池--&gt;
          &lt;bean id&#x3D;&quot;durid&quot; class&#x3D;&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt;
              &lt;property name&#x3D;&quot;driverClassName&quot; value&#x3D;&quot;$&#123;prpo.driverClass&#125;&quot;&gt;&lt;&#x2F;property&gt;
              &lt;property name&#x3D;&quot;url&quot; value&#x3D;&quot;$&#123;prpo.url&#125;&quot;&gt;&lt;&#x2F;property&gt;
              &lt;property name&#x3D;&quot;username&quot; value&#x3D;&quot;$&#123;prpo.userName&#125;&quot;&gt;&lt;&#x2F;property&gt;
              &lt;property name&#x3D;&quot;password&quot; value&#x3D;&quot;$&#123;prpo.password&#125;&quot;&gt;&lt;&#x2F;property&gt;
          &lt;&#x2F;bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</blockquote>
<h4 id="基于注解方式注入属性"><a href="#基于注解方式注入属性" class="headerlink" title="基于注解方式注入属性"></a>基于注解方式注入属性</h4><blockquote>
<ol>
<li><p>什么是注解：</p>
<ol>
<li>注解是代码的特殊标记，格式：@注解名称(属性名称&#x3D;属性值属性名称&#x3D;属性值)</li>
<li>注解作用于方法、类、属性上面</li>
</ol>
</li>
<li><p>目的：简化xml配置</p>
</li>
<li><p>Bean管理</p>
<ol>
<li>@Component：普通注解、都可以创建对象</li>
<li>@Service：业务逻辑层</li>
<li>@Controller：web层、控制层</li>
<li>@Repository：dao层</li>
<li>四个注解功能一样，都可以用来出创建beans对象</li>
</ol>
</li>
<li><p>基于注解方式实现对象创建</p>
<ol>
<li><p>引入aop依赖</p>
</li>
<li><p>开启组件扫描</p>
<ol>
<li>&#96;&#96;&#96;xml<!--地址修改-->
<a target="_blank" rel="noopener" href="http://www.springframework.org/schema/context">http://www.springframework.org/schema/context</a>   <a target="_blank" rel="noopener" href="https://www.springframework.org/schema/context/spring-context.xsd">https://www.springframework.org/schema/context/spring-context.xsd</a>“<!--    开启组件扫描-->
&lt;context:component-scan base-package&#x3D;”com.dy.spring2”&gt;</context:component-scan><pre class="line-numbers language-none"><code class="language-none">
3. 创建类为类添加注解

   1. &#96;&#96;&#96;java
      @Service(value &#x3D; &quot;UserService&quot;)
      public class UserService &#123;
                                                                                                                                                                                                                        
          public void add()&#123;
              System.out.println(&quot;Service add...&quot;);
          &#125;
                                                                                                                                                                                                                        
      &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol>
<li>注解中vlaue的值可以不写，默认为类的名称，首字母为小写</li>
</ol>
</li>
</ol>
</li>
<li><p>组件扫描细节配置</p>
<ol>
<li><p>user-default-filters：包含的规则（过滤）,默认是true，为全部都扫描</p>
</li>
<li><p>意义：只扫描spring2里的Controller注解，在expression里定义</p>
</li>
<li><p>&#96;&#96;&#96;xml</p>
<!--    示例1-->
<p>&lt;context:component-scan base-package&#x3D;”com.dy.spring2” use-default-filters&#x3D;”false”&gt;<br>&lt;context:include-filter type&#x3D;”annotation” expression&#x3D;”org.springframework.stereotype.Controller”&#x2F;&gt;<br></context:component-scan></p>
<pre class="line-numbers language-none"><code class="language-none">
4. context:exclude表示为不扫描哪一个标签

5. &#96;&#96;&#96;xml
   &lt;context:component-scan base-package&#x3D;&quot;com.dy.spring2&quot;&gt;
       &lt;context:exclude-filter type&#x3D;&quot;annotation&quot; expression&#x3D;&quot;org.springframework.stereotype.Controller&quot;&#x2F;&gt;
   &lt;&#x2F;context:component-scan&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
<li><p>基于注解实现属性注入</p>
<ol>
<li><p>@Autowired：根据属性类型进行注入</p>
<ol>
<li>&#96;&#96;&#96;java<br> &#x2F;&#x2F;    属性上添加属性注解<br>&#x2F;&#x2F;    不需要添加set方法<br>@Autowired  &#x2F;&#x2F;根据类型进行注入<br>private UserDao ud;<pre class="line-numbers language-none"><code class="language-none">   
2. @Quailfier：根据属性名称进行注入

   1. 和@Quaifier一起使用

   2. 当一个接口有多个对象时，通过属性类型注入就会失败，需要添加Quaillfier(value&#x3D;&quot;属性名&quot;)进行区分

   3. &#96;&#96;&#96;java
       @Autowired  &#x2F;&#x2F;根据类型进行注入
      @Qualifier(value &#x3D; &quot;userDaoImp1&quot;)
      private UserDao ud;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
<li><p>@Resource：根据类型或者名称注入</p>
<ol>
<li><p>可以根据类型和名称注入</p>
</li>
<li><p>&#96;&#96;&#96;java<br> @Resource(name &#x3D; “userDaoImp1”)<br>private UserDao ud1;</p>
<pre class="line-numbers language-none"><code class="language-none">
4. @Value：注入普通类型属性

   1. 为属性注入值

   2. &#96;&#96;&#96;java
       @Value(value &#x3D; &quot;启动&quot;)
      private String stat;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</blockquote>
<h4 id="完全注解开发"><a href="#完全注解开发" class="headerlink" title="完全注解开发"></a>完全注解开发</h4><blockquote>
<ol>
<li><p>创建配置类</p>
<ol>
<li>&#96;&#96;&#96;java<br>@Configuration &#x2F;&#x2F;作为配置类<br>@ComponentScan(basePackages &#x3D; {“com.dy.spring2”})&#x2F;&#x2F;开启注解扫描<pre class="line-numbers language-none"><code class="language-none">
2. 等价于

3. &#96;&#96;&#96;xml
   &lt;context:component-scan base-package&#x3D;&quot;com.dy.spring2&quot;&gt;&lt;&#x2F;context:component-scan&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
<li><p>创建测试类</p>
<ol>
<li><p>将引入配置文件布置换为引入配置类</p>
</li>
<li><p>&#96;&#96;&#96;<br>ApplicationContext context &#x3D; new AnnotationConfigApplicationContext(SpringConfig.class);</p>
<pre class="line-numbers language-none"><code class="language-none">


## AOP

1. 面向切面编程（方面），利用AOP对**业务逻辑的各个部分进行隔离**，从而使得业务逻辑各部分耦合度降低，提高程序的可读性和开发效率
2. 通俗概念：不通过修改源代码添加新的功能

### 1. 底层原理

1. AOP底层：动态代理
   1. 有接口，使用JDK动态代理
      1. 创建接口实现类代理对象，增强类的方法
   2. 无接口，使用CGLIB动态代理
      1. 创建子类代理对象，进行方法增强

#### jdk动态代理

&#96;&#96;&#96;java
    java.lang.reflect.Proxy &#x2F;&#x2F;Proxy类下的
    newProxyInstance(ClassLoader loader, 类&lt;?&gt;[] interfaces, InvocationHandler h) &#x2F;&#x2F;方法<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
<li><p>调用newProxyInstance方法进行实现</p>
</li>
<li><p>static Object（静态方法）</p>
<ol>
<li>newProxyInstance(ClassLoader loader, 类&lt;?&gt;[] interfaces, InvocationHandler h)	返回指定接口的代理类的实例，该接口方法调用分派给指定的调用处理程序</li>
<li>ClassLoader：类加载器</li>
<li>Interfaces：增强方法所在的类，这个类实现多个接口，支持多个接口</li>
<li>InvocationHandler： 实现这个接口InvocationHandler，创建代理对象，写增强方法</li>
</ol>
</li>
</ol>
</blockquote>
<h5 id="代码实现jdk动态代理"><a href="#代码实现jdk动态代理" class="headerlink" title="代码实现jdk动态代理"></a>代码实现jdk动态代理</h5><blockquote>
<ol>
<li><p>创建接口和接口类</p>
</li>
<li><p>调用JDKProxy实现动态代理</p>
</li>
<li><p>动态代理方法</p>
</li>
<li><pre><code class="java">public static void main(String[] args) &#123;
    UserDao ud = new UserDaoImp();
    MyHandlerProxy invocation = new MyHandlerProxy(ud);
    UserDao proxy =  (UserDao)Proxy.newProxyInstance(ud.getClass().getClassLoader(),
            ud.getClass().getInterfaces(),
            invocation);
    System.out.println(ud.add(1,2));
    System.out.println(proxy.add(1,2));
&#125;
<pre class="line-numbers language-none"><code class="language-none">
### 2. AOP常用术语

1. 连接点
   1. 类中方法可以被增强的方法称为连接点
2. 切入点
   1. 实际被增强的方法称为切入点
3. 通知（增强）
   1. 实际增强的逻辑部分称为通知（例如在登录中加入权限判断的功能）
   2. 通知类型
      1. 前置通知
      2. 后置通知
      3. 环绕通知
         1. 前执行或者后执行
      4. 异常通知
      5. 最终通知：（finally）最后都要执行
4. 切面
   1. 把通知运用到切入点的过程

### 3. AOP操作

#### 1. 准备

1. spring框架一般基于AspectJ实现AOP操作

   1. AspectJ是一种独立的AOP框架

2. 基于AspectJ实现AOP操作

   1. 基于配置文件操作
   2. 基于注解方式实现操作

3. 引入依赖

   1. maven导入的依赖包

   2. &#96;&#96;&#96;xml
      &lt;dependency&gt;
          &lt;groupId&gt;org.springframework&lt;&#x2F;groupId&gt;
          &lt;artifactId&gt;spring-aspects&lt;&#x2F;artifactId&gt;
          &lt;version&gt;5.2.6.RELEASE&lt;&#x2F;version&gt;
      &lt;&#x2F;dependency&gt;
                                                                                                      
      &lt;dependency&gt;
          &lt;groupId&gt;org.aspectj&lt;&#x2F;groupId&gt;
          &lt;artifactId&gt;aspectjweaver&lt;&#x2F;artifactId&gt;
          &lt;version&gt;1.9.6&lt;&#x2F;version&gt;
          &lt;scope&gt;runtime&lt;&#x2F;scope&gt;
      &lt;&#x2F;dependency&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;aopalliance&lt;&#x2F;groupId&gt;
          &lt;artifactId&gt;aopalliance&lt;&#x2F;artifactId&gt;
          &lt;version&gt;1.0&lt;&#x2F;version&gt;
      &lt;&#x2F;dependency&gt;
      &lt;dependency&gt;
          &lt;groupId&gt;net.sourceforge.cglib&lt;&#x2F;groupId&gt;
          &lt;artifactId&gt;com.springsource.net.sf.cglib&lt;&#x2F;artifactId&gt;
          &lt;version&gt;2.2.0&lt;&#x2F;version&gt;
      &lt;&#x2F;dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
<li><p>切入点表达方式</p>
<ol>
<li>作用：知道对那个类里面的那个方法进行增强</li>
<li>语法结构：<ol>
<li>execution([ 权限修饰符 ] [返回类型] [类全路径] [方法名称] (参数列表))</li>
</ol>
</li>
<li>例子：<ol>
<li>execution(*.com.dy.BookDao.add(..))<ol>
<li>增强add方法</li>
</ol>
</li>
<li>execution(*.com.dy.BookDao.*(..))<ol>
<li>增强BookDao下的所有方法</li>
</ol>
</li>
<li>execution(*.com.dy.*.*(..))<ol>
<li>增强dy包下的所有方法</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</blockquote>
<h4 id="2-基于注解实现操作："><a href="#2-基于注解实现操作：" class="headerlink" title="2.基于注解实现操作："></a>2.基于注解实现操作：</h4><blockquote>
<ol>
<li><p>创建类</p>
</li>
<li><p>创建增强类，在增强类里创建方法</p>
</li>
<li><p>修改配置文件</p>
<ol>
<li><p>开启aspectj生产代理对象</p>
</li>
<li><p>&#96;&#96;&#96;xml<br><a href="aop:aspectj-autoproxy">aop:aspectj-autoproxy</a></aop:aspectj-autoproxy></p>
<pre class="line-numbers language-none"><code class="language-none">
2. 创建目标类和增强类

3. 将目标类的增强类注解实例

4. 在增强类添加注解@Aspect（代表生产代理对象）

   1. 增强类注释

   2. &#96;&#96;&#96;java
      @Component
      @Aspect &#x2F;&#x2F; 生产代理对象，切面
      public class UserProxy &#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
<li><p>使用execution方法增加通知</p>
<ol>
<li><p>ProceedingJoinPoint processJoinPoint为环绕通知添加方法执行的次序</p>
</li>
<li><p>执行：processJoinPoint.proceed();</p>
</li>
<li><p>&#96;&#96;&#96;java<br>&#x2F;&#x2F;    前置通知<br>@Before(value &#x3D; “execution(* com.dy.aop.aopanno.service.imp.UserServiceImp.add(..))”)<br>public void before(){<br>    System.out.println(“前置增加”);<br>}<br>&#x2F;&#x2F;  最终通知，无论是否有异常都要执行<br>@After(value &#x3D; “execution(* com.dy.aop.aopanno.service.imp.UserServiceImp.add(..))”)<br>public void after(){<br>    System.out.println(“after”);<br>}<br>&#x2F;&#x2F; 后置通知，返回值后执行，报错不执行<br>@AfterReturning(value”execution(<em>com.dy.aop.aopanno.service.imp.UserServiceImp.add(..))”)<br>public void afterReturning(){<br>    System.out.println(“after Return”);<br>}<br>&#x2F;&#x2F; 异常通知<br>@AfterThrowing(value &#x3D; “execution(</em> com.dy.aop.aopanno.service.imp.UserServiceImp.add(..))”)<br>public void afterThrowing(){<br>    System.out.println(“afterThrowing”);<br>}<br>&#x2F;&#x2F;环绕通知 环绕之后属于后置通知<br>@Around(value &#x3D; “execution(* com.dy.aop.aopanno.service.imp.UserServiceImp.add(..))”)<br>public void around(ProceedingJoinPoint processJoinPoint) throws Throwable {<br>    System.out.println(“环绕前”);<br>    processJoinPoint.proceed();<br>    System.out.println(“环绕后”);</p>
<pre class="line-numbers language-none"><code class="language-none">


1. 重用切入点

   1. 对重复的切入点进行抽取

   2. 注解类@Pointcut(value &#x3D; &quot;切入点&quot;)

   	3. &#96;&#96;&#96;Java
          @Pointcut(value &#x3D; &quot;execution(* com.dy.aop.aopanno.service.imp.UserServiceImp.add(..))&quot;)
           public void pointcut()&#123;
      
       	&#x2F;&#x2F;    前置通知
       	     @Before(value &#x3D; &quot;pointcut()&quot;)
       	  public void before()&#123;
       	         System.out.println(&quot;前置增加&quot;);
       	         System.out.println(&quot;公共抽取类&quot;);
       	     &#125;
       	 &#125;



2. 对一个类里多个方法进行增强

   1. 注解@Order(1)进行优先级设置，数字越低优先级越高

   2. &#96;&#96;&#96;java
      @Component
      @Aspect
      @Order(1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
</ol>
</blockquote>
<h4 id="3-AspectJ配置文件"><a href="#3-AspectJ配置文件" class="headerlink" title="3. AspectJ配置文件"></a>3. AspectJ配置文件</h4><blockquote>
<ol>
<li><p>创建两个类，增强类和目标类</p>
</li>
<li><p>在spring配置中 创建两个对象</p>
</li>
<li><p>在spring配置中加入切入点</p>
<ol>
<li><p>xml切入点于切面配置</p>
</li>
<li><p>&#96;&#96;&#96;xml</p>
<!--aop配置增强-->
<pre><code>&lt;aop:config&gt;
</code></pre>
<!--        切入点-->
<pre><code>    &lt;aop:pointcut id=&quot;p&quot; expression=&quot;execution(* com.dy.aop.xmlclass.dao.User.add(..))&quot;/&gt;
</code></pre>
<!--        配置切入面-->
<pre><code>    &lt;aop:aspect ref=&quot;prouser&quot;&gt;//增强类
        &lt;aop:before method=&quot;before&quot; pointcut-ref=&quot;p&quot;&gt;&lt;/aop:before&gt;
    &lt;/aop:aspect&gt;
&lt;/aop:config&gt;
</code></pre>
<pre class="line-numbers language-none"><code class="language-none">
#### 4. 完全注解开发

配置类：

1. &#96;&#96;&#96;java
   @Configuration &#x2F;&#x2F;作为配置类
   @ComponentScan(basePackages &#x3D; &#123;&quot;com.dy.aop.aopanno&quot;&#125;)&#x2F;&#x2F;开启注解配置
   @EnableAspectJAutoProxy(proxyTargetClass &#x3D; true)&#x2F;&#x2F;生产代理对象
   public class AopConfig &#123;
                                                                                       
   &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
</ol>
</blockquote>
<h2 id="JdbcTemplate"><a href="#JdbcTemplate" class="headerlink" title="JdbcTemplate"></a>JdbcTemplate</h2><h3 id="1-开始准备"><a href="#1-开始准备" class="headerlink" title="1. 开始准备"></a>1. 开始准备</h3><blockquote>
<ol>
<li><p>导入依赖</p>
</li>
<li><pre><code class="xml">&lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt;
    &lt;/dependency&gt;
                                                                                 
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-tx&lt;/artifactId&gt;
    &lt;/dependency&gt;
                                                                                 
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework&lt;/groupId&gt;
        &lt;artifactId&gt;spring-orm&lt;/artifactId&gt;
    &lt;/dependency&gt;
                                                                                 
    &lt;dependency&gt;
        &lt;groupId&gt;com.alibaba&lt;/groupId&gt;
        &lt;artifactId&gt;druid&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;mysql&lt;/groupId&gt;
        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
<pre class="line-numbers language-none"><code class="language-none">
3. 在spring配置文件配置数据库连接池》》》ioc容器引入外部文件有

4. 配置JdbcTemplate对象，注入DataSource

   1. xml文件注入

   2. &#96;&#96;&#96;xml
      &lt;!--   引入外部属性文件--&gt;
          &lt;context:property-placeholder location&#x3D;&quot;classpath:jdbc.properties&quot;&#x2F;&gt;
                                                                                       
          &lt;!--连接池--&gt;
          &lt;bean id&#x3D;&quot;dataSource&quot; class&#x3D;&quot;com.alibaba.druid.pool.DruidDataSource&quot;&gt;
              &lt;property name&#x3D;&quot;driverClassName&quot; value&#x3D;&quot;$&#123;prpo.driverClass&#125;&quot;&gt;&lt;&#x2F;property&gt;
              &lt;property name&#x3D;&quot;url&quot; value&#x3D;&quot;$&#123;prpo.url&#125;&quot;&gt;&lt;&#x2F;property&gt;
              &lt;property name&#x3D;&quot;username&quot; value&#x3D;&quot;$&#123;prpo.userName&#125;&quot;&gt;&lt;&#x2F;property&gt;
              &lt;property name&#x3D;&quot;password&quot; value&#x3D;&quot;$&#123;prpo.password&#125;&quot;&gt;&lt;&#x2F;property&gt;
          &lt;&#x2F;bean&gt;
      &lt;!--创建连接--&gt;
          &lt;bean id&#x3D;&quot;myjdbc&quot; class&#x3D;&quot;org.springframework.jdbc.core.JdbcTemplate&quot;&gt;
      &lt;!--        注入数据库信息--&gt;
              &lt;property name&#x3D;&quot;dataSource&quot; ref&#x3D;&quot;dataSource&quot;&gt;&lt;&#x2F;property&gt;
          &lt;&#x2F;bean&gt;
      &lt;!--开启注解扫描--&gt;
          &lt;context:component-scan base-package&#x3D;&quot;com.dy.spring.demo1&quot;&gt;&lt;&#x2F;context:component-scan&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
<li><p>利用注解创建service和dao对象</p>
</li>
</ol>
</blockquote>
<h3 id="数据库基本操作"><a href="#数据库基本操作" class="headerlink" title="数据库基本操作"></a>数据库基本操作</h3><h4 id="1-增加操作"><a href="#1-增加操作" class="headerlink" title="1. 增加操作"></a>1. 增加操作</h4><blockquote>
<ol>
<li><p>对应数据库创建实体类&gt;&gt;&gt;&gt;Po类</p>
</li>
<li><p>创建连接属性并进行注解实例化</p>
<ol>
<li><p>xml文件下进行实例化</p>
</li>
<li><p>&#96;&#96;&#96;java<br>@Autowired<br>private JdbcTemplate myjdbc;</p>
<pre class="line-numbers language-none"><code class="language-none">
3. 在dao进行数据库添加操作

   1. 相当于把jdbc功能封装了

   2. &#96;&#96;&#96;java
       @Autowired  &#x2F;&#x2F;注解引入myjdbc类
      private JdbcTemplate myjdbc;
                                                                                                                                                                        
      public boolean add(User user) &#123;
      &#x2F;&#x2F;      创建sql语句
              String sql &#x3D; &quot;insert into user values(?,?,?)&quot;;
      &#x2F;&#x2F;
              int i &#x3D; myjdbc.update(sql,user.getName(),user.getAge(),user.getGender());
      &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
</ol>
</blockquote>
<h4 id="2-删除操作"><a href="#2-删除操作" class="headerlink" title="2. 删除操作"></a>2. 删除操作</h4><blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">delet</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"delete from user where id=?"</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> flag <span class="token operator">=</span> myjdbc<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h4 id="3-修改操作"><a href="#3-修改操作" class="headerlink" title="3. 修改操作"></a>3. 修改操作</h4><blockquote>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">updata</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">"update user set name=?,age=?,gender=? where id=?"</span><span class="token punctuation">;</span>
    <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> obj <span class="token operator">=</span> <span class="token punctuation">&#123;</span>user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> flag <span class="token operator">=</span> myjdbc<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h4 id="4-查询操作"><a href="#4-查询操作" class="headerlink" title="4.查询操作"></a>4.查询操作</h4><blockquote>
<ol>
<li><p>查询返回记录数：</p>
<ol>
<li><p>queryForObject(sql, Object.class):</p>
<ol>
<li>第一个是数据库语句</li>
<li>第二个是返回参数类型</li>
</ol>
</li>
<li><p>&#96;&#96;&#96;java<br>String sql &#x3D; “select count(*) from user”;<br>int count &#x3D; myjdbc.queryForObject(sql,Integer.class);<br>return count;</p>
<pre class="line-numbers language-none"><code class="language-none">   
2. 查询返回某个对象

   1. queryForObject(String sql, RowMapper&lt;T&gt; rowMapper, Object... args):

      1. 数据库语句
      2. 返回不同数据类型，利用接口实现类完成数据封装
      3. sql语句值

   2. &#96;&#96;&#96;java
      String sql &#x3D; &quot;select * from user where id&#x3D;?&quot;;
      User user &#x3D; myjdbc.queryForObject(sql,new BeanPropertyRowMapper&lt;User&gt;(User.class),id);
      return user;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
<li><p>查询返回集合</p>
<ol>
<li><p>返回集合调用query方法完成</p>
</li>
<li><pre><code class="Java">String sql = &quot;select * from user where name=?&quot;;
List&lt;User&gt; userList = myjdbc.query(sql,new BeanPropertyRowMapper&lt;User&gt;(User.class),name);
return userList;
<pre class="line-numbers language-none"><code class="language-none">
#### 5. 批量操作

操作表里的多条数据

1. 批量添加

   1. batchUpdata函数，底层会给你遍历取出逐个加入

   2. &#96;&#96;&#96;java
       public boolean addList(List&lt;Object[]&gt; batchArgs) &#123;
              String sql &#x3D; &quot;insert into user (name, gender,age) values(?,?,?)&quot;;
              int[] ins &#x3D; myjdbc.batchUpdate(sql,batchArgs);
              return true;
          &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
<li><p>列表赋值</p>
<ol>
<li>Object[] 数组里的值与sql语句里缺少值的数量要一致</li>
</ol>
</li>
<li><p>&#96;&#96;&#96;java<br>List&lt;Object[]&gt; addList &#x3D; new ArrayList&lt;&gt;();<br>Object[] o1 &#x3D; {“李四”, “女”, “24”};<br>Object[] o2 &#x3D; {“李四”, “男”, “34”};<br>Object[] o3 &#x3D; {“李四”, “女”, “20”};<br>addList.add(o1);<br>addList.add(o2);<br>addList.add(o3);<br>usr.addList(addList);</p>
<pre class="line-numbers language-none"><code class="language-none">
2. 批量修改

   1. &#96;&#96;&#96;java
      public boolean updataList(List&lt;Object[]&gt; batchArgs) &#123;
          String sql &#x3D; &quot;update user set name&#x3D;?,gender&#x3D;?,age&#x3D;? where id&#x3D;?&quot;;
          int[] ins &#x3D; myjdbc.batchUpdate(sql,batchArgs);
                                                                              
          return false;
      &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
<li><p>批量删除</p>
<ol>
<li>&#96;&#96;&#96;java<br>public void deleteList(List&lt;Object[]&gt; batchArgs) {<br>String sql &#x3D; “delete from user where id&#x3D;?”;<br>int[] ins &#x3D; myjdbc.batchUpdate(sql, batchArgs);<br>}<pre class="line-numbers language-none"><code class="language-none">
## 事务操作：

### 1. 概述

1. 事务管理添加到javaee三层结构里的Service层里
2. 事务管理操作：
   1. 编程式事务管理
   2. 声明式事务管理
3. spring一般使用声明式事务管理
   1. 基于注解方式
   2. 基于xml配置文件方式
4. 底层使用AOP 原理
5. spring事务管理API
   1. 提供一个接口代表事务管理器，针对不同框架提供不同实现类
   2. 调用PlatformTransactionManager接口下的方法进行实现
6. 当service业务处理发生异常时，事务会进行回滚，不进行操作，不发生异常就操作完

### 2. 基于注解方式配置进行事务管理

1. 在xml文件里声明TransationManager，事务管理器

2. &#96;&#96;&#96;xml
   &lt;bean id&#x3D;&quot;TransactionManager&quot; class&#x3D;&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt;
       &lt;property name&#x3D;&quot;dataSource&quot; ref&#x3D;&quot;dataSource&quot;&gt;&lt;&#x2F;property&gt;&lt;!--注入属性连接池--&gt;
   &lt;&#x2F;bean&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
<li><p>引入名称空间tx</p>
</li>
<li><pre><code class="xml">xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;
<pre class="line-numbers language-none"><code class="language-none">
5. 开启事务注解

   1. 将刚才创建的事务管理器放入transaction-manager里

   2. &#96;&#96;&#96;xml
      &lt;tx:annotation-driven transaction-manager&#x3D;&quot;TransactionManager&quot;&gt;&lt;&#x2F;tx:annotation-driven&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
<li><p>在service类里添加事务注解：</p>
<ol>
<li><p>注解可添加到类或者方式上</p>
</li>
<li><p>&#96;&#96;&#96;java<br>@Transactional</p>
<pre class="line-numbers language-none"><code class="language-none">
      1. 添加到类上&gt;&gt;&gt;&gt;代表类中方法都添加事务
      2. 方法上只代表方法上添加事务

#### 1. 在事务管理中配置参数

&gt;在Transactional中配置属性参数

##### propagation()


1. 事务传播行为：在不同事务之间进行操作，进行互相调用的行为

2. 事务方法：对数据库表数据进行变化的操作

3. REQUIRED

   1. 当前方法有事务，调用方法就在这个事务里运行，没有事务则调用方法新创建一个事务

4. REQUIRED_NEW

   1. 无论当前方法有没有事务，调用方法都创建新的事务

5. &#96;&#96;&#96;JAVA
   @Service
   @Transactional(propagation &#x3D; Propagation.REQUIRED)
   public class UserService &#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
</ol>
</blockquote>
<h5 id="isolation"><a href="#isolation" class="headerlink" title="isolation()"></a><strong>isolation()</strong></h5><blockquote>
<ol>
<li><p>事务隔离级别</p>
</li>
<li><p>特性：隔离性、、、多事务操作不会产生影响</p>
<ol>
<li><p>不考虑隔离性产生的问题：脏读、不可重复读、虚（幻）读</p>
<ol>
<li>脏读：一个<strong>未提交</strong>事务读取另一个<strong>未提交</strong>事务的数据</li>
<li>不可重复读：一个<strong>未提交</strong>的事务读取到另一个<strong>提交</strong>事务修改、</li>
<li>虚读：一个<strong>未提交</strong>的事务读取到另一个<strong>提交</strong>事务添加数据</li>
</ol>
</li>
<li><p>设置隔离级别解决只读问题</p>
<ol>
<li><table>
<thead>
<tr>
<th align="left">参数</th>
<th>脏读</th>
<th>不可重复读</th>
<th align="left">幻读</th>
</tr>
</thead>
<tbody><tr>
<td align="left">READ_COMMITTED（读未提交）</td>
<td>有</td>
<td>有</td>
<td align="left">有</td>
</tr>
<tr>
<td align="left">READ_UNCOMMITTED（读已提交）</td>
<td>无</td>
<td>有</td>
<td align="left">有</td>
</tr>
<tr>
<td align="left">REPEATABLE_READ（可重复读）（mysql默认设置）</td>
<td>无</td>
<td>无</td>
<td align="left">有</td>
</tr>
<tr>
<td align="left">SERIALIZABLE（串行化）</td>
<td>无</td>
<td>无</td>
<td align="left">无</td>
</tr>
</tbody></table>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</blockquote>
<h5 id="timeout"><a href="#timeout" class="headerlink" title="timeout()"></a>timeout()</h5><blockquote>
<ol>
<li>在一定时间内将那些提交，未提交进行事务回滚</li>
<li>默认时间-1:表示未不超时</li>
<li>设置时间以秒单位进行计算</li>
</ol>
</blockquote>
<h5 id="readOn"><a href="#readOn" class="headerlink" title="readOn()"></a>readOn()</h5><blockquote>
<ol>
<li>默认值为false,可以进行增删改查操作</li>
<li>true:只能进行查找操作</li>
</ol>
</blockquote>
<h5 id="roolbackFor-：回滚"><a href="#roolbackFor-：回滚" class="headerlink" title="roolbackFor()：回滚"></a>roolbackFor()：回滚</h5><blockquote>
<ol>
<li>设置查询那些异常进行事务回滚</li>
</ol>
</blockquote>
<h5 id="noRollbackFor-：不回滚"><a href="#noRollbackFor-：不回滚" class="headerlink" title="noRollbackFor()：不回滚"></a>noRollbackFor()：不回滚</h5><blockquote>
<ol>
<li>设置那些异常不进行事务回滚</li>
</ol>
</blockquote>
<h3 id="3-基于xml方式声明事务管理（待定）"><a href="#3-基于xml方式声明事务管理（待定）" class="headerlink" title="3. 基于xml方式声明事务管理（待定）"></a>3. 基于xml方式声明事务管理（待定）</h3><blockquote>
<ol>
<li>配置事务管理器</li>
<li>配置通知</li>
<li>配置切入点和切面</li>
</ol>
</blockquote>
<h3 id="4-完全注解开发-完全注解声明式事务管理"><a href="#4-完全注解开发-完全注解声明式事务管理" class="headerlink" title="4. 完全注解开发(完全注解声明式事务管理)"></a>4. 完全注解开发(完全注解声明式事务管理)</h3><blockquote>
<ol>
<li><p>创建一个配置类</p>
</li>
<li></li>
<li><p>&#96;&#96;&#96;java<br>@Configuration<br>@ComponentScan(basePackages &#x3D; “com.dy.spring.demo2”)<br>&#x2F;&#x2F;开启事务注解扫描<br>@EnableTransactionManagement<br>public class TransactionConfig {</p>
<p>&#x2F;&#x2F;    创建一个数据库连接池 与配置文件中功能相同<br>@Bean<br>public DruidDataSource getDruidDataSource(){<br>    DruidDataSource dataSource &#x3D; new DruidDataSource();<br>    dataSource.setDriverClassName(“com.mysql.jdbc.Driver”);<br>    dataSource.setUrl(“jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;userdb”);<br>    dataSource.setUsername(“root”);<br>    dataSource.setPassword(“root”);<br>    return dataSource;<br>}<br>&#x2F;&#x2F;    创建数据库配置<br>@Bean<br>public JdbcTemplate getJdbcTemplate(DataSource dataSource){<br>&#x2F;&#x2F;        在IOC容器中找到同类型的进行注入<br>    JdbcTemplate myjdbc &#x3D; new JdbcTemplate();<br>    myjdbc.setDataSource(dataSource);<br>    return myjdbc;<br>}<br>&#x2F;&#x2F;    创建事务管理器<br>@Bean<br>public DataSourceTransactionManager dataSourceTransactionManager(DataSource dataSource){<br>    DataSourceTransactionManager dataSourceTransactionManager &#x3D; new DataSourceTransactionManager();<br>    dataSourceTransactionManager.setDataSource(dataSource);<br>    return dataSourceTransactionManager;<br>}<br><br>}</p>
<pre class="line-numbers language-none"><code class="language-none">
## spring5新功能

### 整合日志框架

&gt;spring5新功能

&gt;1. 整个spring5框架基于java8，运行时兼容jkd9,许多不建议使用的类和方法在代码库中删除

&gt;2. spring5自带通用的日志封装

 1. Log4j2

 2. Spring框架整合Log4j2框架

    1. 引入相关jar包或者依赖

       1. maven导入相关的包

       2. &#96;&#96;&#96;xml
          &lt;dependency&gt;
              &lt;groupId&gt;org.apache.logging.log4j&lt;&#x2F;groupId&gt;
              &lt;artifactId&gt;log4j-api&lt;&#x2F;artifactId&gt;
              &lt;version&gt;2.11.2&lt;&#x2F;version&gt;
          &lt;&#x2F;dependency&gt;
          &lt;dependency&gt;
              &lt;groupId&gt;org.apache.logging.log4j&lt;&#x2F;groupId&gt;
              &lt;artifactId&gt;log4j-core&lt;&#x2F;artifactId&gt;
              &lt;version&gt;2.11.2&lt;&#x2F;version&gt;
          &lt;&#x2F;dependency&gt;
          &lt;dependency&gt;
              &lt;groupId&gt;org.slf4j&lt;&#x2F;groupId&gt;
              &lt;artifactId&gt;slf4j-api&lt;&#x2F;artifactId&gt;
              &lt;version&gt;1.7.30&lt;&#x2F;version&gt;
          &lt;&#x2F;dependency&gt;
          &lt;dependency&gt;
              &lt;groupId&gt;org.apache.logging.log4j&lt;&#x2F;groupId&gt;
              &lt;artifactId&gt;log4j-slf4j-impl&lt;&#x2F;artifactId&gt;
              &lt;version&gt;2.11.2&lt;&#x2F;version&gt;
          &lt;&#x2F;dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ol start="2">
<li><p>创建log4j2.xml配置文件</p>
<ol>
<li><p>日志结构</p>
</li>
<li><p>&#96;&#96;&#96;xml</p>
<?xml version="1.0" encoding="UTF-8" ?>
<configuration status="INFO">
<!-- 先定义所有的appender-->
    <appenders>
<!-- 输出日志信息到控制台-->
        <console name="Console" target="SYSTEM_OUT">
<!--  控制日志输出的格式-->
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n"/>
        </console>
    </appenders>
<!--定义loggers,引入appender，定义loggers并引入appender才会生效-->
<!--    root:用于知道项目的跟目录，如果没有单独指定Logger,则会使用root作为默认日志输出-->
    <loggers>
        <root level="info">
            <appender-ref ref="Console"/>
        </root>
    </loggers>
</configuration>
<pre class="line-numbers language-none"><code class="language-none">
### Nullable注解和函数式注册对象

1. @Nullable注解可以使用在方法、属性、参数。表示方法返回值、属性、参数可以为空

2. 核心容器支持函数式风格：

   1. 可以基于这个创建对象，name可以为空

   2. &#96;&#96;&#96;java
      public void testGenericApplication()&#123;
          GenericApplicationContext context &#x3D; new GenericApplicationContext();
          context.refresh();
          context.registerBean(&quot;userUservice&quot;(@Nullable),UserService.class() -&gt; new UserService());
          UserService us &#x3D; (UserService) context.getBean(&quot;com.dy.spring.demo2.service.UserService&quot;);
      &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
</li>
</ol>
</li>
</ol>
</blockquote>
<h3 id="junit测试框架"><a href="#junit测试框架" class="headerlink" title="junit测试框架"></a>junit测试框架</h3><blockquote>
<ol>
<li><p>引入相关的测试依赖</p>
<ol>
<li><pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework&lt;/groupId&gt;
    &lt;artifactId&gt;spring-test&lt;/artifactId&gt;
&lt;/dependency&gt;
<pre class="line-numbers language-none"><code class="language-none">
2. 创建测试类

   1. &#96;&#96;&#96;Java
      ApplicationContext context &#x3D; new ClassPathXmlApplicationContext(&quot;beans2.xml&quot;);
      UserService us &#x3D; context.getBean(&quot;userService&quot;, UserService.class);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</code></pre>
</li>
<li><p>两个效果等同</p>
</li>
<li><pre><code class="java">//指定相关的j4版本
@RunWith(SpringJUnit4ClassRunner.class)
 @ContextConfiguration(&quot;classpath:beans2.xml&quot;)
</code></pre>
</li>
<li><p>使用注解实例化对象</p>
</li>
</ol>
</li>
</ol>
</blockquote>
<h2 id="webFlux"><a href="#webFlux" class="headerlink" title="webFlux"></a>webFlux</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><blockquote>
<ol>
<li>一种一步非阻塞的框架、在Servlet3.1以后才进行支持，核心时基于Reactor相关的API 实现</li>
<li>异步与同步：针对调用者来说<ol>
<li>同步：调用者发送请求后接受者回应之后，调用者才可以做其他处理</li>
<li>异步：调用者发送请求后接受者不需要回，调用者也可以做其他事务处理</li>
</ol>
</li>
<li>阻塞与非阻塞：针对被调用者<ol>
<li>阻塞：接收者接受请求后，完成请求之后才给出反馈</li>
<li>非阻塞：接收者接受请求后，没有完成请求就先给出反馈</li>
</ol>
</li>
<li>响应式编程<ol>
<li></li>
</ol>
</li>
</ol>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-12-16T02:42:00.000Z" title="2022/12/16 10:42:00">2022-12-16</time>发表</span><span class="level-item"><time dateTime="2022-12-16T04:51:11.863Z" title="2022/12/16 12:51:11">2022-12-16</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/blog/">blog</a></span><span class="level-item">2 分钟读完 (大约365个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/16/hexo-github/">如何使用hexo与github搭建个人博客</a></h1><div class="content"><h1 id="使用hexo与github搭建个人博客"><a href="#使用hexo与github搭建个人博客" class="headerlink" title="使用hexo与github搭建个人博客"></a>使用hexo与github搭建个人博客</h1><h2 id="前置需要"><a href="#前置需要" class="headerlink" title="前置需要"></a>前置需要</h2><ul>
<li>git</li>
<li>node.js -v16.15.1</li>
<li>github下一个username.github.io仓库</li>
</ul>
<p><strong>git下载</strong><br>windows: <a target="_blank" rel="noopener" href="https://git-scm.com/download/win">git</a></p>
<p><strong>node.js</strong><br>官方平台安装：<a target="_blank" rel="noopener" href="https://nodejs.org/en/download/">Node.js</a></p>
<blockquote>
<p>版本仅供参考</p>
</blockquote>
<h2 id="搭建流程"><a href="#搭建流程" class="headerlink" title="搭建流程"></a>搭建流程</h2><p><strong>hexo官方文档</strong></p>
<p><a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">官方文档 | Hexo</a></p>
<p><strong>安装hexo</strong></p>
<p>使用npm安装hexo</p>
<pre class="line-numbers language-none"><code class="language-none">$ npm install -g hexo-cli<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>初始化hexo</strong></p>
<p>在你创建的文档里</p>
<pre class="line-numbers language-none"><code class="language-none">$ hexo init &lt;folder&gt;
$ npm install<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<blockquote>
<p>folder 为生成在那个文档路径下，默认为当前文档</p>
</blockquote>
<p><strong>生成的文档结构</strong></p>
<pre class="line-numbers language-none"><code class="language-none">.
├── _config.yml
├── package.json
├── scaffolds
├── source
|   ├── _drafts
|   └── _posts
└── themes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>**$\color</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-12-15T02:42:00.000Z" title="2022/12/15 10:42:00">2022-12-15</time>发表</span><span class="level-item"><time dateTime="2022-12-16T02:44:56.724Z" title="2022/12/16 10:44:56">2022-12-16</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/hexo/">hexo</a></span><span class="level-item">几秒读完 (大约14个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/12/15/hello-wrod/">hello world</a></h1><div class="content"><h1 id="IceBlog"><a href="#IceBlog" class="headerlink" title="IceBlog"></a>IceBlog</h1><ul>
<li>2022&#x2F;22&#x2F;15</li>
</ul>
<p>没啥写的</p>
<p>少年游</p>
<p>祝你考研上岸</p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatat.jpg" alt="duyao"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">duyao</p><p class="is-size-6 is-block">冰海</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>学习记录学习</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">2</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">4</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/duyaostudy" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/duyaostudy"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="微信" href="https://weixin.com"><i class="fab fa-wechat"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="git" href="https://gitee.com"><i class="fab fa-git"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="qq" href="https://qq.com"><i class="fab fa-qq"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-12-16T04:53:30.127Z">2022-12-16</time></p><p class="title"><a href="/2022/12/16/Spring5/"> </a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-12-16T02:42:00.000Z">2022-12-16</time></p><p class="title"><a href="/2022/12/16/hexo-github/">如何使用hexo与github搭建个人博客</a></p><p class="categories"><a href="/categories/blog/">blog</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-12-15T02:42:00.000Z">2022-12-15</time></p><p class="title"><a href="/2022/12/15/hello-wrod/">hello world</a></p><p class="categories"><a href="/categories/hexo/">hexo</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/12/"><span class="level-start"><span class="level-item">十二月 2022</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/blog/"><span class="tag">blog</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github/"><span class="tag">github</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/myblog/"><span class="tag">myblog</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/blog/"><span class="level-start"><span class="level-item">blog</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/hexo/"><span class="level-start"><span class="level-item">hexo</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://baidu.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">百度</span></span><span class="level-right"><span class="level-item tag">baidu.com</span></span></a></li></ul></div></div></div></div><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3 is-sticky"><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/ice-logo.svg" alt="冰海" height="28"></a><p class="is-size-7"><span>&copy; 2022 duyao</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/duyaostudy/hexo-theme-icarus-duyao"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>